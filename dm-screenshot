#!/usr/bin/env bash

screenshotTool="maim"

[ ! -x "$(which "$screenshotTool")" ] && notify-send "$screenshotTool not installed" && exit 0

imgName="screenshot-$(date "+%d-%m-%y@%h:%m:%s").png"
screenshotDir="$HOME/Pictures/Screenshot"
notifMsg="Screenshot saved as $imgName"

screenshotCMD="$screenshotTool -u -f png -m 1 $screenshotDir/$imgName"

dmenuCMD=$(printf '%s\n' "1.quick-fullscreen" "2.delayed-fullscreen" "3.section" "4.view-screenshots" | dmenu -p "Select a mode")

cd "$screenshotDir" || exit
case ${dmenuCMD%% *} in
    1.quick-fullscreen) $screenshotCMD && notify-send "$notifMsg" ;;
    2.delayed-fullscreen) $screenshotCMD -d 4 && notify-send "$notifMsg" ;;
    3.section) $screenshotCMD -s && notify-send "$notifMsg"  ;;
    4.view-screenshots) sxiv $screenshotDir ;;

    *)  exec "${dmenuCMD}"  ;;
esac
